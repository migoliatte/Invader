#include <stdio.h>
#include <string.h>
// gcc -o exploit exploit.c -z execstack -m32
// gcc -fno-stack-protector exploit.c && ./a.out

unsigned char code[] = \
"\x31\xc0\x31\xdb\x31\xd2\xb0\x04\xb3\x04\x01\xd8\x83\xc0\x30\x50\xb0\x04\xb3\x01\x89\xe1\xb2\x01\xcd\x80\xb0\x01\x31\xdb\xcd\x80";

int main() {
printf("Shellcode Length: %lu\n", sizeof(code)-1); // subtract null byte
int (*ret)() = (int(*)())code;
ret();
return 0;
}